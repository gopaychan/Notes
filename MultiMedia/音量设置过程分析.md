##### 开机音量预设
1. AudioService的构造方法里面调用了createStreamStates方法。system_process进程创建的时候会新建AudioService并start。在SystemServer的startOtherService方法里面。
2. createStreamStates根据NUM_STREAM_TYPES新建对应的VolumeStreamState对象，保存在mStreamStates数组里面；每个VolumeStreamState（mIndexMin，mIndexMax为实际配置的*10）对象里面每个device对应一个index（音量），保存在对象的mIndexMap（SparseIntArray）里面。
3. VolumeStreamState的构造方法会调用readSettings配置各个device的音量。如果mStreamType为STREAM_SYSTEM或者STREAM_SYSTEM_ENFORCED的话读取配置的默认值如果mCameraSoundForced为true，则读取配置的最大值，设置到default的device（代码：```mIndexMap.put(AudioSystem.DEVICE_OUT_DEFAULT, index)```），其他的读取保存在Settings.System里面的settings值，key格式volume_music_speaker（volume_music为Settings.VOLUME_SETTINGS_INT里面各个流的对应值，speaker为```AudioSystem.getOutputDeviceName(int device)```返回的）如果值==-1就不保存，否则保存（```mIndexMap.put(device, getValidIndex(10 * index))```，ps:不保存的获取的时候会用对应的default的index）。
4. 调用checkAllFixedVolumeDevices方法，如果当前流或流的alias是STREAM_MUSIC且divice是mFullVolumeDevices或mFixedVolumeDevices且index不为零（静音）对应的流类型的VolumeStreamState里面对应device的index设为mIndexMax并设置到底层（AudioPolicyService）使之生效。
5. 调用checkAllAliasStreamVolumes方法，把所有Alias对应的流对应的device的index设置上，最后调用applyAllVolumes方法把各个Stream对应的device的音量值设置到底层（AudioPolicyService）使之生效。
6. 调用checkMuteAffectedStreams方法，排除call流对于静音状态影响的标签，如果应用有MODIFY_PHONE_STATE权限是可以吧call设置成静音的（call流默认最小音量为1）
7. 调用updateDefaultVolumes方法，更新所有default的volume（前面check的时候可能音量会改变）
##### 开机后应用对音量设置的调用
##### 音量设置与AudioPolicyService的关系